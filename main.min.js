
(()=>{'use strict';const throttle =(fn,delay = 200)=>{let timeoutId = null;let lastExec = 0;return function throttled(...args){const now = Date.now();const remaining = delay -(now - lastExec);if(remaining <= 0){lastExec = now;if(timeoutId){clearTimeout(timeoutId);timeoutId = null}fn.apply(this,args)}else if(!timeoutId){timeoutId = setTimeout(()=>{lastExec = Date.now();timeoutId = null;fn.apply(this,args)},remaining)}}};function initPreloader(){window.addEventListener('load',()=>{const preloader = document.getElementById('preloader');if(!preloader)return;preloader.style.transition = 'opacity 0.5s ease';preloader.style.opacity = '0';setTimeout(()=> preloader.remove(),500)})}function initBeforeAfterCarousel(){const wrapper=document.getElementById('beforeAfterWrapper');if(!wrapper||wrapper.dataset.loopInitialized==='true')return;const cards=Array.from(wrapper.querySelectorAll('.transformation-card'));const originalCount=cards.length;if(!originalCount)return;const isMobile=window.innerWidth<768;if(!isMobile){const fragment=document.createDocumentFragment();cards.forEach(card=>{const clone=card.cloneNode(true);const images=clone.querySelectorAll('img');images.forEach(img=>{img.setAttribute('loading','lazy')});fragment.appendChild(clone)});wrapper.appendChild(fragment);wrapper.dataset.loopInitialized='true';const updateSettings=()=>{const firstCard=wrapper.querySelector('.transformation-card');if(!firstCard)return;requestAnimationFrame(()=>{const styles=window.getComputedStyle(wrapper);const gap=parseFloat(styles.gap||styles.columnGap||'0')||0;const cardWidth=firstCard.getBoundingClientRect().width;const totalWidth=originalCount*(cardWidth+gap);wrapper.style.setProperty('--before-after-translate',`-${totalWidth}px`);wrapper.style.setProperty('--before-after-duration','40s');});};const throttledUpdate=throttle(updateSettings,200);window.addEventListener('resize',throttledUpdate);window.addEventListener('orientationchange',throttledUpdate);window.addEventListener('load',updateSettings);updateSettings();wrapper.classList.add('is-loop-ready');wrapper.style.animationPlayState='running';const observer=new IntersectionObserver((entries)=>{entries.forEach(entry=>{if(entry.isIntersecting){wrapper.style.animationPlayState='running'}else{wrapper.style.animationPlayState='paused'}});},{rootMargin:'50px'});observer.observe(wrapper)}else{wrapper.dataset.loopInitialized='true'}}function initTestimonialsCarousel(){const wrapper=document.getElementById('carouselWrapper');const container=document.querySelector('.carousel-container');const dotsContainer=document.getElementById('carouselDots');if(!wrapper||!container||!dotsContainer)return;const slides=Array.from(wrapper.querySelectorAll('.carousel-slide'));const totalSlides=slides.length;if(!totalSlides)return;let slidesToShow=window.innerWidth<=768?1:3;let currentIndex=0;const maxIndex=Math.max(0,totalSlides-slidesToShow);let autoplay=null;function buildDots(){dotsContainer.innerHTML='';for(let i=0;i<=maxIndex;i+=1){const dot=document.createElement('button');dot.className='carousel-dot';if(i===0)dot.classList.add('active');dot.setAttribute('aria-label',`Go to slide ${i+1}`);dot.addEventListener('click',()=>goToSlide(i));dotsContainer.appendChild(dot)}}function updateCarousel(){const slideWidth=100/slidesToShow;const offset=currentIndex*slideWidth;wrapper.style.transform=`translateX(-${offset}%)`;dotsContainer.querySelectorAll('.carousel-dot').forEach((dot,index)=>{dot.classList.toggle('active',index===currentIndex)})}function goToSlide(index){currentIndex=index;updateCarousel()}function moveCarousel(direction){currentIndex+=direction;if(currentIndex<0)currentIndex=maxIndex;if(currentIndex>maxIndex)currentIndex=0;updateCarousel()}function handleResize(){const newSlidesToShow=window.innerWidth<=768?1:3;if(newSlidesToShow!==slidesToShow){slidesToShow=newSlidesToShow;currentIndex=0;updateCarousel()}}function startAutoplay(){stopAutoplay();autoplay=setInterval(()=>moveCarousel(1),5000)}function stopAutoplay(){if(autoplay)clearInterval(autoplay);autoplay=null}buildDots();updateCarousel();startAutoplay();window.addEventListener('resize',throttle(handleResize,150));window.addEventListener('orientationchange',throttle(handleResize,150));document.addEventListener('visibilitychange',()=>{if(document.hidden)stopAutoplay();else startAutoplay()})}function initTimelineProgress(){const section = document.getElementById('whySection');const progressLine = document.getElementById('progressLine');if(!section || !progressLine)return;const updateProgressLine =()=>{const sectionRect = section.getBoundingClientRect();const windowHeight = window.innerHeight;const triggerPoint = windowHeight * 0.5;const sectionTop = sectionRect.top;const sectionHeight = sectionRect.height;if(sectionTop < triggerPoint){const scrolled = triggerPoint - sectionTop;const percentage =(scrolled / sectionHeight)* 100;progressLine.style.height = `${Math.min(100,Math.max(0,percentage))}%`}else{progressLine.style.height = '0%'}};const throttledUpdate = throttle(updateProgressLine,100);window.addEventListener('scroll',throttledUpdate,{passive:true});window.addEventListener('resize',throttledUpdate);window.addEventListener('load',updateProgressLine);updateProgressLine()}function initPricingCurrency(){const currencySelect=document.getElementById('currencySelect');const planCards=document.querySelectorAll('.pricing-card[data-plan-duration]');if(!currencySelect||!planCards.length)return;const pricingData={AED:{symbol:'AED',plans:{1:{total:1000,perWeek:233},3:{total:2700,perWeek:210},6:{total:4800,perWeek:187}}},EUR:{symbol:'â‚¬',plans:{1:{total:250,perWeek:58},3:{total:675,perWeek:52},6:{total:1200,perWeek:47}}},AUD:{symbol:'AUD',plans:{1:{total:480,perWeek:112},3:{total:1300,perWeek:100},6:{total:2300,perWeek:88}}}};function updatePricing(currency){const currencyData=pricingData[currency];if(!currencyData)return;const promoActive=typeof isPromoActive==='function'?isPromoActive():false;planCards.forEach(card=>{const duration=parseInt(card.dataset.planDuration,10);const plan=currencyData.plans[duration];if(!plan)return;const totalEl=card.querySelector('[data-plan-total]');const monthlyEl=card.querySelector('[data-plan-monthly]');const savingEl=card.querySelector('[data-plan-saving]');if(totalEl)totalEl.textContent=`${plan.total} ${currencyData.symbol}`;if(promoActive&&typeof PROMO_CONFIG!=='undefined'&&PROMO_CONFIG.offers[duration]&&PROMO_CONFIG.offers[duration].enabled){const offer=PROMO_CONFIG.offers[duration];const totalDuration=duration+offer.extraMonths;const totalWeeks=totalDuration*4;const promoPerWeek=Math.round(plan.total/totalWeeks);if(monthlyEl)monthlyEl.textContent=`${promoPerWeek} ${currencyData.symbol}/week`;card.classList.add('promo-active');let badge=card.querySelector('.promo-badge');if(!badge){badge=document.createElement('div');badge.className='promo-badge';card.insertBefore(badge,card.firstChild)}badge.textContent=offer.label;if(savingEl){const oneMonthTotal=pricingData[currency].plans[1].total;const totalIfNormalPrice=oneMonthTotal*totalDuration;const promoPrice=plan.total;const promoSaving=totalIfNormalPrice-promoPrice;if(promoSaving>0){savingEl.innerHTML=`<div class="saving-stamp"><div class="stamp-label">SAVE MONEY</div><div class="stamp-amount">${promoSaving} ${currencyData.symbol}</div></div>`;savingEl.classList.add('promo-saving');savingEl.style.display='flex'}else{savingEl.style.display='none'}}}else{if(monthlyEl)monthlyEl.textContent=`${plan.perWeek} ${currencyData.symbol}/week`;card.classList.remove('promo-active');const badge=card.querySelector('.promo-badge');if(badge)badge.remove();if(savingEl&&duration>1){const oneMonthTotal=pricingData[currency].plans[1].total;const oneMonthPerWeek=pricingData[currency].plans[1].perWeek;const monthsCount=duration;const totalIfMonthly=oneMonthTotal*monthsCount;const saving=totalIfMonthly-plan.total;if(saving>0){savingEl.innerHTML=`<div class="saving-stamp"><div class="stamp-label">SAVE MONEY</div><div class="stamp-amount">${saving} ${currencyData.symbol}</div></div>`;savingEl.classList.add('regular-saving');savingEl.style.display='flex'}else{savingEl.style.display='none'}}else if(savingEl){savingEl.style.display='none'}}})}updatePricing(currencySelect.value);currencySelect.addEventListener('change',(e)=>updatePricing(e.target.value))}document.addEventListener('DOMContentLoaded',()=>{initPreloader();initBeforeAfterCarousel();initTestimonialsCarousel();initTimelineProgress();initPricingCurrency()})})();